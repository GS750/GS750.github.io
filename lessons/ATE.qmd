---
title: "Treatment Effect Estimation"
webr:
show-startup-message: false \# Display status of webR initialization
---

# How can we estimate treatment effect?

**Example:** Suppose you decided to test whether the new method improves test scores. They randomly assign 10 of your students to the new method (**Treatment Group**) and 10 students to the regular method (**Control Group**).

| Group             | Test Scores                               |
|------------------|-------------------------------------------|
| Treatment Group   | 88, 90, 85, 92, 87, 91, 89, 93, 90, 88   |
| Control Group     | 80, 82, 78, 85, 81, 79, 83, 84, 82, 80   |

How can you evaluate the effect of the new method (treatment)?

::: {.callout-tip appearance="simple", collapse="false"}
## Treatment effect estimation
After performing a randomized experiment, we can **directly compare the two groups** by looking at the difference in their average outcomes.
:::

**Step 1: Calculate the average score**

- **Treatment Group average:**  
$$\frac{88 + 90 + 85 + 92 + 87 + 91 + 89 + 93 + 90 + 88}{10} = 89.3$$

- **Control Group average:**  
$$
\frac{80 + 82 + 78 + 85 + 81 + 79 + 83 + 84 + 82 + 80}{10} = 81.4
$$

**Step 2: Compare the averages**

The difference is:  
$89.3 - 81.4 = 7.9 \text{ points}$

Since the students were randomly assigned, we can be confident that this difference is **caused by the new study program** rather than other factors.


::: {.callout-warning}

This gives us a single-number estimate of the difference between the groups. However, **we canâ€™t yet conclude whether this difference is statistically significant**. Donâ€™t worry â€” future statistics classes will teach us how to test that! ðŸ™‚

:::

## Try it yourself!

```{webr-r}
#| context: output

library(htmltools)

# Create UI elements
tagList(
  tags$div(
    style = "font-family: sans-serif; max-width: 500px; margin: 20px auto; padding: 20px;",
    tags$p("Suppose a randomized experiment gives the following group averages:"),
    tags$ul(
      tags$li(tags$b("Treatment Group average:"), " 89.3"),
      tags$li(tags$b("Control Group average:"), " 81.4")
    ),
    tags$p("What is the difference between the Treatment and Control group averages?"),
    tags$input(
      id = "answer",
      type = "number",
      placeholder = "Enter your answer",
      style = "font-size: 16px; padding: 5px; width: 100px; margin-right: 10px; border-radius: 5px; border: 1px solid #ccc;"
    ),
    tags$button(
      "Check Answer",
      id = "check",
      style = "font-size: 16px; padding: 5px 10px; border-radius: 5px; border: none; background-color: #4A90E2; color: white; cursor: pointer;"
    ),
    tags$p(id = "feedback", style = "font-size: 16px; margin-top: 10px;")
  ),
  
  # Add JS interactivity
  tags$script(HTML("
    const correctAnswer = 89.3 - 81.4; // 7.9
    document.getElementById('check').onclick = function() {
      const userAnswer = parseFloat(document.getElementById('answer').value);
      const feedback = document.getElementById('feedback');
      
      if (isNaN(userAnswer)) {
        feedback.textContent = 'Please enter a number.';
        feedback.style.color = 'red';
      } else if (Math.abs(userAnswer - correctAnswer) < 0.01) {
        feedback.textContent = 'Correct! ðŸŽ‰';
        feedback.style.color = 'green';
      } else {
        feedback.textContent = 'Not quite. Try again!';
        feedback.style.color = 'red';
      }
    };
    
    // Disable arrow keys in number input
    document.getElementById('answer').addEventListener('keydown', function(event) {
      if(event.key === 'ArrowUp' || event.key === 'ArrowDown') {
        event.preventDefault();
      }
    });
  "))
)


```

